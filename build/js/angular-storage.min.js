angular.module("angular.plugins.storage",[]).provider("$storage",function(){var t=NaN;this.setDefaultTemplateTimeout=function(n){t=parseInt(n)},this.$get=["$window",function(n){var e=n.localStorage,r=function(t){return a(t)?e.getItem(t):null},o=function(t,n,r){null!==n&&""!==n&&(r=parseInt(r),r>0&&(setTimeout(function(){u(t)},r),e.setItem(t+"/expire",Date.now()+r)),e.setItem(t,n))},a=function(t){if(t.match(/\/expire$/i))return!1;var n=parseInt(e.getItem(t+"/expire"));return Date.now()>n?(u(t),!1):e.hasOwnProperty(t)},u=function(t){e.removeItem(t),e.removeItem(t+"/expire")},i=function(t){return angular.fromJson(r(t))},c=function(t,n,e){o(t,angular.toJson(n,!1),e)},f=function(t,n){return["document",t,n].join("/")},m=function(t,n){return["template",t,n].join("/")},l=function(){return Math.floor(Math.random()*Math.pow(16,8)).toString(16)+"-"+Math.floor(Math.random()*Math.pow(16,4)).toString(16)+"-"+Math.floor(Math.random()*Math.pow(16,4)).toString(16)+"-"+Math.floor(Math.random()*Math.pow(16,4)).toString(16)+"-"+Math.floor(Math.random()*Math.pow(16,12)).toString(16)};return{clear:function(){e.clear()},searchDocuments:function(t,n){n=n||function(t,n){return!0};for(var r=[],o=0,u=e.length;u>o;o++){var c=e.key(o);if(a(c)){var f=c.split("/");if("document"==f[0]&&f[1]==t){var m=i(c);n(m,f[2])&&r.push(m)}}}return r},getDocument:function(t,n){return i(f(t,n))},putDocument:function(t,n,e,r){return n=n||l(),c(f(t,n),e,r),n},hasDocument:function(t,n){return a(f(t,n))},removeDocument:function(t,n){u(f(t,n))},getTemplate:function(t,n){return r(m(t,n))},putTemplate:function(n,e,r,a){isNaN(parseInt(a))&&(a=t),o(m(n,e),r,a)},hasTemplate:function(t,n){return a(m(t,n))},removeTemplate:function(t,n){u(m(t,n))}}}]});